# 　WSL2 Ubuntu経由で立ち上げるテキストが日本語で問題なく表示されるために必要な操作

## **ステップ1: Windows側で日本語の言語パックとフォントをインストール**

### **1.1 日本語の言語パックをインストール**

1. **設定を開く**

   - Windowsの「スタート」ボタンをクリックし、**設定**（歯車アイコン）を選択します。

2. **時刻と言語を選択**

   - 「時刻と言語」をクリックします。

3. **言語を選択**

   - 左側のメニューから「言語」を選びます。

4. **言語の追加**

   - 「優先する言語」の下にある**「言語の追加」**ボタンをクリックします。

5. **日本語を追加**

   - リストから**「日本語」**を選択し、インストールします。
   - **言語機能のインストール**画面で、「表示言語としてインストール」「テキスト読み上げ」「音声認識」「手書き入力」などのオプションを選択できますが、**フォントのインストール**は必ず選択してください。

### **1.2 日本語フォントの確認**

- 日本語の言語パックをインストールすると、必要な日本語フォント（例：Yu Gothic、MS Gothic）が自動的にインストールされます。

---

## **ステップ2: WSL2 Ubuntuのロケールを日本語に設定**

### **2.1 ロケールを日本語（UTF-8）に設定**

1. **ロケールの生成**

   ```bash
   sudo locale-gen ja_JP.UTF-8
   ```

2. **ロケール設定の更新**

   ```bash
   sudo update-locale LANG=ja_JP.UTF-8
   ```

3. **設定の確認**

   ```bash
   locale
   ```

   - `LANG=ja_JP.UTF-8`となっていることを確認します。

4. **ターミナルの再起動**

   - WSL2ターミナルを閉じて再度開き、ロケール設定を反映させます。

---

## **ステップ3: 必要なパッケージとフォントをWSL2にインストール**

### **3.1 システムのアップデート**

```bash
sudo apt-get update
```

### **3.2 日本語フォントのインストール**

```bash
sudo apt-get install -y fonts-takao
```

- **注:** WSL2上でGUIアプリケーションを使用する場合に必要です。

### **3.3 日本語環境用のパッケージをインストール**

```bash
sudo apt-get install -y language-pack-ja
```

---

## **ステップ4: スクリプトの修正（ファイルのエンコーディングを明示）**

### **4.1 ファイルの読み書き時にエンコーディングを指定**

- ファイルを読み込む際、エンコーディングを明示的に`'utf8'`に指定します。

  ```javascript
  let content = fs.readFileSync(newPath, 'utf8')
  ```

- ファイルを書き込む際も、エンコーディングを指定します。

  ```javascript
  fs.writeFileSync(newPath, content, 'utf8')
  ```

### **4.2 HTMLファイルの`<meta charset>`タグを確認**

- HTMLファイルの`<head>`セクションに、以下のタグが含まれていることを確認します。

  ```html
  <meta charset="UTF-8" />
  ```

- **不足している場合**、スクリプトで自動的に追加することも検討してください。

### **4.3 追加するHTMLコンテンツのエンコーディングを確認**

- スクリプトでHTMLに追加している文字列がUTF-8で正しくエンコードされていることを確認します。

---

## **ステップ5: ブラウザの設定を確認**

### **5.1 ブラウザのエンコーディングをUTF-8に設定**

- **Google Chromeの場合:**
  - 最新のChromeでは手動でエンコーディングを変更するオプションがありませんが、通常は自動的にUTF-8を検出します。
- **Microsoft EdgeまたはFirefoxの場合:**
  - メニューから「文字エンコーディング」または「エンコード」を選択し、**「Unicode（UTF-8）」**を選びます。

### **5.2 ブラウザに日本語フォントが正しく表示されるか確認**

- ブラウザで他の日本語のウェブサイトを開き、文字化けが発生していないか確認します。

---

## **ステップ6: レポートを再生成して確認**

### **6.1 スクリプトを実行**

- スクリプトを再度実行して、レポートを生成します。

  ```bash
  ./scripts/lighthouse-manager.js rename-and-process
  ```

### **6.2 レポートを開く**

- 生成されたHTMLレポートをブラウザで開き、日本語が正しく表示されているか確認します。

  ```bash
  ./scripts/lighthouse-manager.js open
  ```

---

## **ステップ7: 追加の確認事項**

### **7.1 HTMLファイルの中身を直接確認**

- テキストエディタでHTMLファイルを開き、日本語が正しく記述されているか確認します。

### **7.2 他の環境でレポートを開く**

- 同じHTMLファイルを別のマシン（例: Macや別のWindows PC）で開き、同じ問題が発生するか確認します。

### **7.3 キャッシュのクリア**

- ブラウザのキャッシュをクリアしてからレポートを再読み込みします。

---

## **まとめ**

- **Windows側で日本語の言語パックとフォントをインストール**することで、ブラウザが日本語を正しく表示できます。
- **WSL2のロケールを日本語に設定**し、文字列の扱いを適切にします。
- **スクリプト内でファイルの読み書き時にUTF-8エンコーディングを明示的に指定**し、文字化けを防ぎます。
- **HTMLファイルに適切な`<meta charset="UTF-8">`タグを含める**ことで、ブラウザが正しいエンコーディングでファイルを表示します。
- **ブラウザの設定を確認**し、エンコーディングがUTF-8に設定されていることを確認します。

---

これらの手順を実行することで、WSL2 Ubuntu経由で立ち上げるテキストが日本語で問題なく表示されるようになります。もし問題が解決しない場合は、追加の情報やエラーメッセージを提供していただければ、さらにサポートいたします。

---
